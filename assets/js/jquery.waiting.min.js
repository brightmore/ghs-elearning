
(function(b){var a={size:0,quantity:10,dotSize:6,enableReverse:true,waitMovementIncrementer:1,light:false,fullScreen:false,speed:100,circleCount:1,tailPercent:0.25};b.waiting=function(d,c){var e=b(d).data("waiting");if(typeof e==="undefined"){e=this;e.el=d;e.$el=b(d);e.$el.data("waiting",e)}if(typeof c==="string"){switch(c){case"pause":e.pause();break;case"play":e.play();break;case"done":e.done();break}}e.init=function(){e.userSettings=b.extend({},a,c);e.position={top:0,left:0,height:0,width:0};e.originalPosition=e.position;e.intervalID=0;e.resizeIntervalID=0;e.createWaiting()};e.pause=function(){clearInterval(e.intervalID)};e.play=function(){e.pause();e.intervalID=setInterval(function(){e.waitingLoopColorChange()},e.userSettings.speed)};e.done=function(){if(typeof e.$mask!=="undefined"){e.pause();e.$mask.remove();e.$el.removeData("waiting")}};e.createWaiting=function(){e.done();if(typeof e.$mask==="undefined"){e.$mask=b('<div style="position:absolute;z-index:9000;background-color:#'+(e.userSettings.light?"9090a6":"222")+';filter:alpha(opacity=50);opacity:0.5;"></div>').appendTo("body");if(e.userSettings.enableReverse){e.$mask.click(function(){e.userSettings.waitMovementIncrementer*=-1})}}if(typeof e.$wait==="undefined"){e.$wait=b('<div class="ringHolder" style="z-index:9001;position:relative;"></div>').appendTo(e.$mask)}e.waitSizing();e.pause();clearInterval(e.resizeIntervalID);e.play();e.resizeIntervalID=setInterval(function(){e.waitingTargetMoved()},20);b(window).resize(function(){e.waitSizing()})};e.waitingTargetMoved=function(){var f=e.$el.is(":hidden");e.$mask.toggle(!f);if(!f){e.getLeftTopHeightWidth();if(e.position.top!==e.originalPosition.top||e.position.left!==e.originalPosition.left||e.position.height!==e.originalPosition.height||e.position.width!==e.originalPosition.width){e.waitSizing()}}};e.getLeftTopHeightWidth=function(){if(e.userSettings.fullScreen){e.position.height=b(window).outerHeight();e.position.width=b(window).outerWidth();e.position.top=window.pageYOffset;e.position.left=window.pageXOffset}else{e.position.height=e.$el.outerHeight();e.position.width=e.$el.outerWidth();if(e.$el.offset()!==undefined){var f=e.$el.offset();e.position.top=f.top;e.position.left=f.left}}return e.position};e.waitSizing=function(){var h=e.userSettings.size;var f=e.userSettings.dotSize;e.getLeftTopHeightWidth();e.resetPosition();var g=e.position.height;var i=e.position.width;if(h===0||(h>(e.position.height-f)||h>(e.position.width-f))){var j=e.userSettings.size;if(e.userSettings.fullScreen){g=b("body").outerHeight();i=b("body").outerWidth();j=Math.min(tempHeight,tempWidth)-f}else{j=(e.position.height<e.position.width?e.position.height:e.position.width)-f}h=j}e.$mask.height(g).width(i).offset({top:e.position.top,left:e.position.left});e.$wait.height(h).width(h).offset({top:(e.position.top+(e.position.height/2-h/2)),left:(e.position.left+(e.position.width/2-h/2))}).html("");e.drawCircles(h)};e.drawCircles=function(q){if(e.$wait.children().filter(".ring").length===0){var j=e.userSettings.dotSize;var h=e.userSettings.quantity;var m=e.userSettings.circleCount;e.loopMax=(h-1);var i=j/2;for(var f=0;f<m;f++){for(var p=0;p<h;p++){var l=q/2;var g=((360/h)*(p+1))*Math.PI/180;var k=l-((f)*(l/m));var o=(l+k*Math.cos(g))-i;var n=(l+k*Math.sin(g))-i;e.$wait.append('<div loopOrder="'+p+'" class="ring" style="filter:alpha(opacity=100); opacity:1; left:'+o+"px; top:"+n+"px; height:"+j+"px; width:"+j+"px; position:absolute; background-color:#777; -moz-border-radius:"+j+"px; -webkit-border-radius:"+j+"px; border-radius:"+j+'px;"></div>')}}}};e.waitingLoopColorChange=function(){e.$wait.children("div").each(function(k,l){$this=b(this);var g=1*$this.attr("loopOrder");var p=(e.userSettings.waitMovementIncrementer*1)>0?1:-1;g+=p;if(g>e.loopMax){g=0}if(g<0){g=e.loopMax}$this.attr("loopOrder",g);var o=e.userSettings.tailPercent*1;if(o>1){o=1}var m=(e.loopMax*o);var n=(m<4?1:(m/4));var f=p>0;var j=e.userSettings.light;var h=j?"#1e64ae":"#666";if(g<=n){h=(f?(j?"#fafcfe":"#ddd"):(j?"#3e84ce":"#888"))}else{if(g<=n*2){h=(f?(j?"#bcd4ee":"#bbb"):(j?"#7dacde":"#999"))}else{if(g<=n*3){h=(f?(j?"#7dacde":"#999"):(j?"#bcd4ee":"#bbb"))}else{if(g<=n*4){h=(f?(j?"#3e84ce":"#888"):(j?"#fafcfe":"#ddd"))}}}}$this.css("backgroundColor",h)})};e.resetPosition=function(){e.originalPosition.top=e.position.top;e.originalPosition.left=e.position.left;e.originalPosition.height=e.position.height;e.originalPosition.width=e.position.width};if(typeof c!=="string"){e.init()}};b.fn.waiting=function(c){return this.each(function(){(new b.waiting(this,c))})}})(jQuery);